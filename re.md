用户输入批量PL，以及一般检验水平或者特殊检验水平。
1.抽样主表的批量位于A/B两列，PL介于AB之间，确定行H1，根据一般检验水平或者特殊检验水平的值为S-1、S-2、S-3、S-4、Ⅰ、Ⅱ、Ⅲ，确定列L1。找到L1与H1交叉的为样本量字码ZM
2.样本量字码位于K列。匹配到对应的样本量字码，确定行H2,根据AQL的值确定列，AQL的值为{0.01		0.015		0.025		0.04		0.065		0.1		0.15		0.25		0.4		0.65		1.0 		1.5		2.5		4.0 		6.5		10		15		25		40		65		100	}，每一个值对应一个AC和RE，比如0对应的AC/RE分别在M和N列。得到LAC和LRE
3.如果LAC与H2交叉的单元格有数字，则对应的数字所在行对应的样本量为检测样本量。
4.如果LAC与H2交叉的单元格没有数字，则根据单元格内的字上或下，
{下	下	下	下	下	下	下	下	下	下	下	下	下	下	下	下	下	下	下	下	下	下	下	下	下	下	下	下	0	1	下	下	下	下	1	2	2	3	3	4	5	6
下	下	下	下	下	下	下	下	下	下	下	下	下	下	下	下	下	下	下	下	下	下	下	下	下	下	0	1	上	上	下	下	1	2	2	3	3	4	5	6	7	8
下	下	下	下	下	下	下	下	下	下	下	下	下	下	下	下	下	下	下	下	下	下	下	下	0	1	上	上	下		1	2	2	3	3	4	5	6	7	8	10	11
下	下	下	下	下	下	下	下	下	下	下	下	下	下	下	下	下	下	下	下	下	下	0	1	上	上	下	下	1	2	3	4	3	4	5	6	7	8	10	11	14	15
下	下	下	下	下	下	下	下	下	下	下	下	下	下	下	下	下	下	下	下	0	1	上	上	下	下	1	2	2	3	3	4	5	6	7	8	10	11	14	15	21	22
下	下	下	下	下	下	下	下	下	下	下	下	下	下	下	下	下	下	0	1	上	上	下	下	1	2	2	3	3	4	5	6	7	8	10	11	14	15	21	22	上	上
下	下	下	下	下	下	下	下	下	下	下	下	下	下	下	下	0	1	上	上	下	下	1	2	2	3	3	4	5	6	7	8	10	11	14	15	21	22	上	上	上	上
下	下	下	下	下	下	下	下	下	下	下	下	下	下	0	1	上	上	下	下	1	2	2	3	3	4	5	6	7	8	10	11	14	15	21	22	上	上	上	上	上	上
下	下	下	下	下	下	下	下	下	下	下	下	0	1	上	上	下	下	1	2	2	3	3	4	5	6	7	8	10	11	14	15	21	22	上	上	上	上	上	上	上	上
下	下	下	下	下	下	下	下	下	下	0	1	上	上	下	下	1	2	2	3	3	4	5	6	7	8	10	11	14	15	21	22	上	上	上	上	上	上	上	上	上	上
下	下	下	下	下	下	下	下	0	1	上	上	下	下	1	2	2	3	3	4	5	6	7	8	10	11	14	15	21	22	上	上	上	上	上	上	上	上	上	上	上	上
下	下	下	下	下	下	0	1	上	上	下	下	1	2	2	3	3	4	5	6	7	8	10	11	14	15	21	22	上	上	上	上	上	上	上	上	上	上	上	上	上	上
下	下	下	下	0	1	上	上	下	下	1	2	2	3	3	4	5	6	7	8	10	11	14	15	21	22	上	上	上	上	上	上	上	上	上	上	上	上	上	上	上	上
下	下	0	1	上	上	下	下	1	2	2	3	3	4	5	6	7	8	10	11	14	15	21	22	上	上	上	上	上	上	上	上	上	上	上	上	上	上	上	上	上	上
0	1	上	上	下	下	1	2	2	3	3	4	5	6	7	8	10	11	14	15	21	22	上	上	上	上	上	上	上	上	上	上	上	上	上	上	上	上	上	上	上	上
}
得到最近的数值。则对应的数字所在行对应的样本量为检测样本量。
5.样本量大于输入的批量则为全检。如果小于输入的批量，则使用样本量检测
6.AQL=0.01对应第O和P列
7.样本量计算excel公式，或者生成计算样本量的vba。样本量计算结果在B4显示

---

## 解决方案已完成

已创建以下文件：

1. **抽样计算.vba** - VBA宏代码，提供自定义函数
   - `=获取样本量(批量, "检验水平", AQL)` - 返回样本量
   - `=获取Ac值(批量, "检验水平", AQL)` - 返回接收数
   - `=获取Re值(批量, "检验水平", AQL)` - 返回拒收数
   - `=获取检验类型(批量, "检验水平", AQL)` - 返回全检/抽检

2. **使用说明.md** - 详细使用文档
3. **使用示例.txt** - Excel工作表布局示例和测试数据

### 快速开始
1. 打开Excel，按Alt+F11打开VBA编辑器
2. 插入→模块，粘贴`抽样计算.vba`中的代码
3. 在单元格中使用公式：`=获取样本量(150, "Ⅱ", 1.5)` 
4. 保存为.xlsm格式（启用宏的工作簿）